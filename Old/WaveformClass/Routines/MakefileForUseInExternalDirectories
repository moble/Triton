## Set these variables as appropriate
BASE = /Users/boyle/Research/WaveExtrapolation/WaveformClass/
SUBLIBS = ${BASE}DataAnalysis ${BASE}Waveforms ${BASE}PostNewtonian ${BASE}Utilities
SOURCES = $(wildcard *.cpp)
EXECUTABLES = $(SOURCES:%.cpp=%)


## This is a basic makefile; the lines below shouldn't need much tweaking.
.PHONY: sublibs $(SUBLIBS)
RM = /bin/rm
CC = g++
OPT = -O3
CFLAGS = -c
WFLAGS = -Wall
IFLAGS:=$(SUBLIBS:%=-I%)
LFLAGS:=$(SUBLIBS:%=-L%)
lFLAGS:=$(SUBLIBS:${BASE}%=-l%)

all: sublibs $(EXECUTABLES)

-include $(EXECUTABLES:=.d)

clean:
	$(RM) -f *.d $(EXECUTABLES)

$(EXECUTABLES): % : %.cpp
	$(CC) $(OPT) $(WFLAGS) $*.cpp $(IFLAGS) $(LFLAGS) $(lFLAGS) -o $@
	@$(CC) -MM $(IFLAGS) $*.cpp > $*.d.tmp
	@sed -e 's/.o:/:/'< $*.d.tmp > $*.d
	@$(RM) -f $*.d.tmp
#	@(pushd ../bin >& /dev/null && ln -sf ../Routines/$@ . ; popd >& /dev/null)

sublibs: $(SUBLIBS)

$(SUBLIBS):
	@$(MAKE) -C $@
